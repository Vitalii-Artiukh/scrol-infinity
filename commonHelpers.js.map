{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst myKeyPixabay = '45488193-7ca777789e7fbcf45aeeb8195'; // key='***'\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const fetchToPixabay = async (questEntered, Page) => {\n  const urlOptions = {\n    params: {\n      page: Page,\n      key: myKeyPixabay,\n      q: questEntered,\n      image_type: 'photo',\n      safesearch: true,\n      orientation: 'horizontal',\n      per_page: 15,\n    },\n  };\n\n  return await axios.get('', urlOptions);\n};\n","export const createGalleryCard = imageSet => {\n  return `<li class=\"gallery-card\">\n            <a href=\"${imageSet.largeImageURL}\" class=\"gallery-link\">\n              <img class=\"image-normal\" src=\"${imageSet.webformatURL}\" alt=\"${imageSet.tags}\"/>\n              <ul class=\"image-text\">\n                <li class=\"image-text-item\">\n                  <p class=\"key key-likes\">Likes</p>\n                  <p class=\"value value-likes\">${imageSet.likes}</p>\n                </li>\n                <li class=\"image-text-item\">\n                  <p class=\"key key-views\">Viwes</p>\n                  <p class=\"value value-views\">${imageSet.views}</p>\n                </li>\n                <li class=\"image-text-item\">\n                  <p class=\"key key-comments\">Comments</p>\n                  <p class=\"value value-comments\">${imageSet.comments}</p>\n                </li>\n                <li class=\"image-text-item\">\n                  <p class=\"key key-downloads\">Downloads</p>\n                  <p class=\"value value-downloads\">${imageSet.downloads}</p>\n                </li>\n              </ul>\n            </a>\n          </li>`;\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { fetchToPixabay } from './js/pixabay-api';\nimport { createGalleryCard } from './js/render-functions';\n\nconst formSerched = document.querySelector('.js-search-form');\nconst gallery = document.querySelector('.js-gallery');\nconst preloader = document.querySelector('.preloader-wrap');\nconst scrollMarkerEl = document.querySelector('.js-scroll-infinity');\nconst goTopBtn = document.querySelector('.js-go-top');\n\nlet searchResault = '';\nlet numberPage = 1;\nlet quantityPages = 1;\nlet heightCard = 0;\n\nconst forRefresh = new SimpleLightbox('.js-gallery a', {\n  captionsData: 'alt',\n  captionDelay: 150,\n});\n\nconst submitSearchPhoto = async event => {\n  try {\n    preloader.classList.remove('is-visible');\n    event.preventDefault();\n    numberPage = 1;\n\n    searchResault = formSerched.elements.user_query.value;\n\n    const response = await fetchToPixabay(searchResault, numberPage);\n\n    quantityPages = response.data.totalHits / 15;\n\n    gallery.innerHTML = '';\n    formSerched.reset();\n\n    if (response.data.hits.length === 0) {\n      preloader.classList.add('is-visible');\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        backgroundColor: '#ef4040',\n        maxWidth: '432px',\n        messageColor: '#fafafb',\n        messageSize: '16px',\n        messageLineHeight: '150%',\n      });\n      return;\n    }\n\n    const photoCardsInfo = response.data.hits\n      .map(details => createGalleryCard(details))\n      .join('');\n\n    gallery.innerHTML = photoCardsInfo;\n    observer.observe(scrollMarkerEl);\n  } catch (error) {\n    iziToast.error({\n      title: `${error}`,\n      position: 'center',\n      backgroundColor: '#ef4040',\n    });\n    formSerched.reset();\n    preloader.classList.add('is-visible');\n    return;\n  }\n\n  preloader.classList.add('is-visible');\n  forRefresh.refresh();\n  numberPage += 1;\n};\n\nconst scrollObserverOptions = {\n  root: null,\n  rootMargin: '0px 0px 400px 0px',\n  threshold: 1,\n};\n\nconst observeMorePhoto = async scrolling => {\n  console.log(scrolling);\n  if (scrolling[0].isIntersecting) {\n    try {\n      const response = await fetchToPixabay(searchResault, numberPage);\n\n      if (Math.ceil(quantityPages) >= numberPage) {\n        const photoCardsInfo = response.data.hits\n          .map(details => createGalleryCard(details))\n          .join('');\n\n        gallery.insertAdjacentHTML('beforeend', photoCardsInfo);\n      }\n\n      forRefresh.refresh();\n\n      numberPage += 1;\n\n      if (Math.ceil(quantityPages) < numberPage) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    } catch (error) {\n      iziToast.error({\n        title: `${error}`,\n        position: 'center',\n        backgroundColor: '#ef4040',\n      });\n    }\n  }\n};\n\nconst observer = new IntersectionObserver(\n  observeMorePhoto,\n  scrollObserverOptions\n);\n\nformSerched.addEventListener('submit', submitSearchPhoto);\n\nconst goTop = () => {\n  if (window.pageYOffset > 0) {\n    window.scrollBy(0, -75);\n    setTimeout(goTop, 0);\n  }\n};\n\nconst goTopWive = () => {\n  const wiveSet = window.pageYOffset;\n  const coordinats = document.documentElement.clientHeight;\n  if (wiveSet > coordinats) {\n    goTopBtn.classList.remove('is-hidden');\n  } else {\n    goTopBtn.classList.add('is-hidden');\n  }\n};\n\ngoTopBtn.addEventListener('click', goTop);\naddEventListener('scroll', goTopWive);\n"],"names":["myKeyPixabay","axios","fetchToPixabay","questEntered","Page","urlOptions","createGalleryCard","imageSet","formSerched","gallery","preloader","scrollMarkerEl","goTopBtn","searchResault","numberPage","quantityPages","forRefresh","SimpleLightbox","submitSearchPhoto","event","response","iziToast","photoCardsInfo","details","observer","error","scrollObserverOptions","observeMorePhoto","scrolling","goTop","goTopWive","wiveSet","coordinats"],"mappings":"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"}